---
import Leaderboard from "./Leaderboard.astro";
---

{/* Main controls container - positioned absolutely in top-left corner */}
<div class="absolute flex flex-col gap-2 transition-all moveable top-2 left-2">
	{/* Zoom controls */}
	<button
		id="zoomIn"
		class="flex items-center justify-center w-10 h-10 transition-all bg-white rounded-md sm:w-8 sm:h-8 hover:bg-gray-100 active:bg-gray-200"
		aria-label="Zoom In"
	>
		<i class="text-lg bi bi-plus sm:text-base"></i>
	</button>

	<button
		id="zoomOut"
		class="flex items-center justify-center w-10 h-10 transition-all bg-white rounded-md sm:w-8 sm:h-8 hover:bg-gray-100 active:bg-gray-200"
		aria-label="Zoom Out"
	>
		<i class="text-lg bi bi-dash sm:text-base"></i>
	</button>

	{/* Trophy icon - toggles leaderboard visibility */}
	<button
		id="leaderboardToggle"
		class="flex items-center justify-center w-10 h-10 transition-all bg-white rounded-md sm:w-8 sm:h-8 hover:bg-gray-100 active:bg-gray-200"
		aria-label="Toggle Leaderboard Visibility"
	>
		<i class="text-lg text-yellow-500 bi bi-trophy sm:text-base"></i>
	</button>

	{/* Chart icon - toggles chart visibility */}
	<button
		id="chartToggle"
		class="flex items-center justify-center w-10 h-10 transition-all bg-white rounded-md sm:w-8 sm:h-8 hover:bg-gray-100 active:bg-gray-200"
		aria-label="Toggle Chart Visibility"
	>
		<i class="text-lg text-teal-500 bi bi-bar-chart sm:text-base"></i>
	</button>

	{/* Legend container for cluster colours */}
	<div id="legend" class="p-2 bg-white rounded-lg"></div>
</div>

{/* Leaderboard container - starts hidden off-screen to the left */}
<div
	id="leaderboardContainer"
	class="absolute top-0 left-0 w-56 transition-all -translate-x-full"
>
	<Leaderboard />
</div>

<script>
	import $ from "jquery";

	$(function () {
		// Define colour ranges for different cluster sizes
		const legendItems = [
			{ range: "1 - 5", colour: "#1abc9c" },
			{ range: "6 - 10", colour: "#9b59b6" },
			{ range: "11 - 15", colour: "#e74c3c" },
			{ range: "16 - 20", colour: "#f1c40f" },
			{ range: "21 - 25", colour: "#e67e22" },
			{ range: "26 +", colour: "#34495e" },
		];

		// Generate HTML for the legend using template literals
		const legendHtml = `
		<h3 class="mb-2 text-sm font-semibold">Clusters</h3>
		<div class="space-y-2">
			${legendItems
				.map(
					(item) => `
				<div class="flex items-center">
					<div class="w-3 h-3 mr-2 rounded-full" style="background-color: ${item.colour};"></div>
					<span class="text-xs">${item.range}</span>
				</div>
			`
				)
				.join("")}
		</div>
		`;

		// Append the generated legend HTML to the legend container
		$("#legend").append(legendHtml);
	});
</script>
